# Финальный проект 
# Прогнозирование оттока клиентов 
### Описание проекта:
Оператор связи хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах. Основная метрика для проверки качества модели - roc_auc, дополнительная метрика – accuracy.
### Описание данных:
Выборка персональных данных клиентов, информация о тарифах и договорах.
### Цель проекта:
- Спрогнозировать отток клиентов мобильного оператора.
- Построить модель со значением метрики качества ROC_AUC не меньше 0.88.
Дополнительно зафиксировать accuracy модели.
### В ходе проекта выполнено:
- Подготовка данных для анализа
- Анализ данных
- Выбор и обучение моделей:
    - Разделиние данных на обучающую и тестовую выборки
    - One-Hot Encoding кодирование признаков
    - Создана Base-line модель
    - Логистическая регрессия
        - Отмасштабированы данные 
        - Применена кросс-валидация
        - Выведены метрики roc_auc и accuracy
    - Random Forest
        - Подбраны гиперпараметры с кросс-валидацией с помощью GridSearchCV
        - Выведены метрики roc_auc и accuracy
    - Градиентный бустинг (CatBoost)
        - Подбраны гиперпараметры с кросс-валидацией с помощью GridSearchCV
        - Выведены метрики roc_auc и accuracy
- Сравнение метрик roc_auc и accuracy и выбор лучшей модели
- Выведены финальные метрики roc_auc и accuracy для модели CatBoost на тестовой выборке
### Вывод:
* Проведён анализ признаков. Можно сказать, что основное удорожание происходит при подключении интернета, и доп. услуг, которые открываются при подключении интернета, также услуга телефонии мультиканальной линии. Также в значительной мере на стоимость оплаты влияет тип оплаты, ежемесячный самый невыгодный (оптом дешевле). Самый невыгодный сценарий для клиента, это ежемесячная оплата, пользование и телефонией, и интернетом и большое количество подключенных дополнительный функций.
* Построена матрица корреляции и отобраны наиболее релевантные для модели признаки.
* Выполнено кодирование признаков методом One-Hot Encoding.
* Для модели Логистической регрессии выполнено масштабирование количественных данных.
- Обучены различные модели бинарной классификации для предсказания оттока клиентов. Использовались метрики roc_auc и accuracy.  
 
| модель | roc_auc | accuracy |  
|:------|:----------:|:--------:|  
| base-line | 0.5 | 0.735 |  
| Логистическая регрессия | 0.843| 0.805 |  
| Random Forest |0.855 | 0.805 |  
| CatBoost | 0.927 | 0.805 |  
| CatBoost test | **0.944** | 0.899 | 
  
- Наилучшее качество предсказания показала модель градиентного бустинга (CatBoost). **roc_auc = 0.944** на тестовой выборке, accuracy = 0.899  
- Наибольший вклад в предсказание модели вносят признаки:
    - `valid_period` - количество дней действия договора
    - `TotalCharges` - общая сумма платежей за всё время услуг
    - `MonthlyCharges` - ежемесячный платёж за услуги.    
    - `fiber_optic` - использование оптоволокна при подключении к интернету
    - `OnlineSecurity` - использование доп. услуги по блокировке небезопасных сайтов
    - `Type_Two year` - тип платежа: раз в два года
    - `TechSupport` - использование доп. услуги выделенной линия технической поддержки
    - `Type_One year` - тип платежа: раз в год ### Используемый стек инструментов:

### Использованный стек инструментов:

- python
- pandas
- numpy
- sklearn
- matplotlib
- seaborn
- catboost


